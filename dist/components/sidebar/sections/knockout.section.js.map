{"version":3,"sources":["components/sidebar/sections/knockout.section.ts"],"names":[],"mappings":";AAAA,IAAY,CAAC,WAAM,QAAQ,CAAC,CAAA;AAE5B,6BAAsB,cAAc,CAAC,CAAA;AAMrC,QAAO,+BAA+B,CAAC,CAAA;AAEvC,IAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,yCAAyC,EAAE,EACzE,CAAC,CAAC;AAEH;;GAEG;AACH;IAQI,eAAe;IACf,+BAAa,MAAsB,EAAE,MAAqC,EAAE,OAAuB,EAAE,EAAa;QATtH,iBAoDC;QA1CO,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;QACd,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QAErB,wBAAwB;QACxB,MAAM,CAAC,MAAM,CAAC,4BAA4B,EAAE;YACxC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;gBAC7C,KAAI,CAAC,UAAU,GAAG,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC;gBAC7C,KAAI,CAAC,gBAAgB,GAAG,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAgB,CAAC;gBAEzD,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAI,CAAC,UAAU,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBACpC,MAAM,CAAC,OAAO,CAAC,mBAAmB,EAAE,EAAE,EAAE;wBACpC,WAAW,EAAE,IAAI;wBACjB,OAAO,EAAE,CAAC;wBACV,eAAe,EAAE,CAAC;qBACrB,CAAC,CAAC;gBACP,CAAC;YACL,CAAC;QACL,CAAC,EAAE,IAAI,CAAC,CAAC;IACb,CAAC;IAEM,qDAAqB,GAA5B,UAA6B,gBAAwB;QAArD,iBAoBC;QAlBG,IAAM,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,wBAAwB,CAAC,CAAC;QAC7E,IAAM,MAAM,GAAG,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAExC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAgB,EAAE,UAAC,EAAE,IAAK,OAAA,EAAE,KAAK,gBAAgB,EAAvB,CAAuB,CAAC,CAAC;QAEvE,IAAI,QAAQ,GAAG;YACX,OAAO,EAAE;gBACL,OAAO,EAAE,gBAAgB;aAC5B;YACD,MAAM,EAAE,MAAM;SACjB,CAAC;QAEF,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAC,QAAQ;YACjE,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;YACjE,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC;YAC/C,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,gBAAgB,GAAG,QAAQ,CAAC,mBAAmB,CAAC,CAAC;YACjE,KAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;IACP,CAAC;IACL,4BAAC;AAAD,CApDA,AAoDC,IAAA;AAED,IAAM,iBAAiB,GAA8B;IACjD,UAAU,EAAE,qBAAqB;IACjC,YAAY,EAAE,MAAM;IACpB,WAAW,EAAK,sBAAO,CAAC,MAAM,CAAC,EAAE,CAAC,iCAA8B;IAChE,QAAQ,EAAE;QACN,MAAM,EAAE,GAAG;KACd;CACJ,CAAC;AAEF,qBAAqB;AACrB,OAAO,CAAC,SAAS,CAAC,YAAY,EAAE,iBAAiB,CAAC,CAAC","file":"knockout.section.js","sourcesContent":["import * as _ from 'lodash';\n\nimport {dirname} from 'decaf-common';\nimport {WSService} from '../../../services/ws';\nimport {ActionsService} from '../../../services/actions/actions.service';\n\nimport * as types from '../../../types';\n\nimport './views/knockout.section.css!';\n\nconst section = angular.module('pathwayvis.components.sections.knockout', [\n]);\n\n/**\n * Knockout component\n */\nclass KnockoutComponentCtrl {\n    public shared: types.Shared;\n    public growthRate: number;\n    public removedReactions: string[];\n    private _ws: WSService;\n    private _actions: ActionsService;\n    private $scope: angular.IScope;\n\n    /* @ngInject */\n    constructor ($scope: angular.IScope, toastr: angular.toastr.IToastrService, actions: ActionsService, ws: WSService) {\n        this._ws = ws;\n        this._actions = actions;\n        this.$scope = $scope;\n\n        // Reaction data watcher\n        $scope.$watch('ctrl.shared.map.growthRate', () => {\n            if (!_.isUndefined(this.shared.map.growthRate)) {\n                this.growthRate = this.shared.map.growthRate;\n                this.removedReactions = this.shared.map.removedReactions;\n\n                if (_.round(this.growthRate, 5) === 0) {\n                    toastr.warning('Growth rate is 0!', '', {\n                        closeButton: true,\n                        timeOut: 0,\n                        extendedTimeOut: 0\n                    });\n                }\n            }\n        }, true);\n    }\n\n    public onReactionRemoveClick(selectedReaction: string): void {\n\n        const undoKnockoutAction = this._actions.getAction('reaction:knockout:undo');\n        const shared = _.cloneDeep(this.shared);\n\n        _.remove(shared.map.removedReactions, (id) => id === selectedReaction);\n\n        let sharedKO = {\n            element: {\n                bigg_id: selectedReaction\n            },\n            shared: shared\n        };\n\n        this._actions.callAction(undoKnockoutAction, sharedKO).then((response) => {\n            this.shared.map.growthRate = parseFloat(response['growth-rate']);\n            this.shared.map.reactionData = response.fluxes;\n            this.shared.map.removedReactions = response['removed-reactions'];\n            this.$scope.$apply();\n        });\n    }\n}\n\nconst KnockoutComponent: angular.IComponentOptions = {\n    controller: KnockoutComponentCtrl,\n    controllerAs: 'ctrl',\n    templateUrl: `${dirname(module.id)}/views/knockout.section.html`,\n    bindings: {\n        shared: '='\n    }\n};\n\n// Register component\nsection.component('pvKnockout', KnockoutComponent);\n"]}